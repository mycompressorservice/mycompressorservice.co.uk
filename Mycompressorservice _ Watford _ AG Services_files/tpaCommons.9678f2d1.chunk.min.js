(self.webpackJsonp__wix_thunderbolt_app=self.webpackJsonp__wix_thunderbolt_app||[]).push([[5776],{53104:function(e,n,t){"use strict";t.r(n),t.d(n,{MasterPageTpaPropsCacheSymbol:function(){return o.lP},PinnedExternalIdStoreSymbol:function(){return o.Aq},TpaContextMappingSymbol:function(){return o.ex},TpaDataCapsuleSymbol:function(){return o.yA},TpaHandlersManagerSymbol:function(){return o.XA},TpaSectionSymbol:function(){return o.B_},TpaSrcBuilderSymbol:function(){return o.RN},TpaSrcUtilitySymbol:function(){return o.NQ},name:function(){return o.u2},site:function(){return j}});var r=t(95793),o=t(20140),a=t(31191),i=t(43757),u=t(56405),c=t(61049),l=t(5096),p=t(58629),s=t(26513),d=t(55048),f=t(16684),g=t.n(f),m=t(29203),v=t(46466),I=(0,i.ff)([(0,i.t6)(c.R9,o.u2)],(function(e){return{getQueryParams:function(n){var t=n.compId,r=n.pageId,o=n.tpaCompData,i=n.options.extraQueryParams,u=e.siteRevision,c=e.viewMode,l=e.deviceType,p=e.locale,s=e.tpaDebugParams,d=e.timeZone,f=e.regionalLanguage,m=o.templateId,v=o.width,I=o.height,y=o.isResponsive;return(0,a.pi)((0,a.pi)({pageId:r,compId:m||t,viewerCompId:t,siteRevision:""+u,viewMode:c,deviceType:l,locale:p,tz:d,regionalLanguage:f,width:!y&&g().isNumber(v)?""+v:null,height:!y&&g().isNumber(I)?""+I:null},s),i)}}})),y=(0,i.ff)([],(function(){return{getQueryParams:function(e){return{externalId:e.tpaCompData.externalId}}}})),h=(0,i.ff)([(0,i.t6)(c.R9,o.u2),u.X],(function(e,n){var t=e.widgetsClientSpecMapData;return{getQueryParams:function(e){var r=e.tpaCompData,o=e.options,a=(t[r.widgetId]||{}).appDefinitionId||o.appDefinitionId||"";return{instance:n.getAppInstanceByAppDefId(a)}}}})),P=(0,i.ff)([(0,i.t6)(c.R9,o.u2),l.ZQ],(function(e,n){return{getQueryParams:function(){var t,r=e.requestUrl,o=e.extras,a=new URL((null===(t=null==n?void 0:n.location)||void 0===t?void 0:t.href)||r);return{currency:o.currency,currentCurrency:a.searchParams.get("currency")||o.currency}}}})),R=(0,i.ff)([p.s],(function(e){var n=e.viewerSessionId;return{getQueryParams:function(){return{vsi:n}}}})),C=(0,i.ff)([m.e],(function(e){return{getQueryParams:function(){var n,t=e.getCurrentConsentPolicy();return{"consent-policy":(n=t).defaultPolicy&&g().every(n.policy)||!e._getConsentPolicyHeader()["consent-policy"]?void 0:decodeURIComponent(e._getConsentPolicyHeader()["consent-policy"])}}}})),w=(0,i.ff)([v.p],(function(e){return{getQueryParams:function(){return{commonConfig:JSON.stringify(e.getCommonConfigForUrl())}}}})),S=(0,i.ff)([s.jj],(function(e){return{getQueryParams:function(){var n,t,r=null===(t=null===(n=e.getCurrentRouteInfo())||void 0===n?void 0:n.dynamicRouteData)||void 0===t?void 0:t.publicData;return{routerData:r?JSON.stringify(r):null}}}})),x=(0,i.ff)([(0,i.t6)(c.R9,o.u2),d.QZ,l.ZQ],(function(e,n,t){return{getQueryParams:function(r){var o,i=r.compId,u=r.tpaCompData,c=r.options,l=e.widgetsClientSpecMapData,p=e.appSectionParams,s=e.isMobileView,d=e.requestUrl,f=e.viewMode,g=e.externalBaseUrl,m={target:null,"section-url":null};if(u.widgetId){var v=l[u.widgetId],I=v.widgetUrl,y=v.mobileUrl,h=s&&y||I,P=((null===(o=n.get(i))||void 0===o?void 0:o.componentType)||"").toLowerCase().endsWith("section");u.isSection&&P&&("site"===f?(m["section-url"]=g+"/"+c.tpaInnerRouteConfig.tpaPageUri+"/",m.target="_top"):(m["section-url"]=h,m.target="_self"))}return(0,a.pi)((0,a.pi)({},function(){var e;if(t){var n=new URL((null===(e=null==t?void 0:t.location)||void 0===e?void 0:e.href)||d).searchParams.get("appSectionParams");return JSON.parse(decodeURIComponent(n||"{}"))||{}}return p}()),m)}}})),D=(0,i.ff)([(0,i.t6)(c.R9,o.u2)],(function(e){var n=e.metaSiteId,r={},o=function(e,n,t){return r[t]},i=function(e,t,o,a){return e.namespace=r[a],e.scope=n,e},u=g().once((function(){return(0,a.mG)(void 0,void 0,void 0,(function(){return(0,a.Jh)(this,(function(e){switch(e.label){case 0:return[4,t.e(6721).then(t.bind(t,36721))];case 1:return(new(e.sent().FrameStorageListener)).start(o,i),[2]}}))}))}));return{registerToDataCapsule:function(e,n){u(),r[e]=n},unregister:function(e){delete r[e]}}})),T=t(59032),b=(0,i.ff)([],(function(){var e={},n={};return{registerTpasForContext:function(n,t){var r=n.contextId,o=n.pageId;t.forEach((function(n){e[n]={contextId:r,pageId:o}}))},getTpaComponentPageInfo:function(n){return e[n]},registerTpaTemplateId:function(e,t){n[e]=t},getTpaComponentIdFromTemplate:function(e){return n[e]}}})),U=t(65070),Q=(0,i.ff)([(0,i.t6)(c.R9,o.u2),l.ZQ,(0,i.fi)(r.R)],(function(e,n,t){var r=e.widgetsClientSpecMapData,o=e.externalBaseUrl,i=e.requestUrl;return{buildSrc:function(e,u,c,l,p){void 0===p&&(p={});var s,d=r[c.widgetId]||{},f=g().merge({tpaInnerRouteConfig:null,extraQueryParams:{},appDefinitionId:""},p),m={compId:e,pageId:u,tpaCompData:c,options:f},v=g().assign.apply(g(),(0,a.ev)([{}],(0,a.CR)(t.map((function(e){return e.getQueryParams(m)}))))),I=f.tpaInnerRouteConfig?function(e,t){var r,u=Boolean(t.tpaPageUri&&!g().isNil(d.applicationId)&&d.applicationId===t.tpaApplicationId),c=(0,a.CR)(((null==n?void 0:n.location.href)||i).replace(o,"").split("?"),1)[0],l=(0,a.CR)(decodeURIComponent(c).split("?"),2),p=l[0],s=l[1],f=u&&(0,U._)(p,t.tpaPageUri);return f&&(null===(r=d.appPage)||void 0===r?void 0:r.defaultPage)&&f.unshift(d.appPage.defaultPage),f?function(e,n,t){if(0===e.length)return n;var r=e.join("/"),o=new URL(n);return o.pathname+="/"+r,t&&new URLSearchParams(t).forEach((function(e,n){return o.searchParams.append(n,e)})),o.href}(f,e,s):e}(l,f.tpaInnerRouteConfig):l;try{s=new URL(I)}catch(e){return""}return g().entries(v).forEach((function(e){var n=(0,a.CR)(e,2),t=n[0],r=n[1];g().isNil(r)||s.searchParams.set(t,r)})),s.href}}})),M=(0,i.ff)([],(function(){var e={},n={};return{registerTpaSection:function(t,r){e[t]=r,n[r.appDefinitionId]=t},unregisterTpaSection:function(t){var r=e[t],o=null==r?void 0:r.appDefinitionId;delete e[t],o&&delete n[o]},getTpaSectionByAppDefinitionId:function(t){var r=n[t];return e[r]}}})),_=t(24263),A=t(97880),N=t(37793),E=function(e){if(e.data)try{return JSON.parse(e.data)}catch(e){}return{}},B=["getWixUpgradeUrl","stylesReady","getViewModeInternal","setHelpArticle"],J=(0,i.ff)([A.D,_._w,o.ex,d.QZ,(0,i.jt)(l.EE),(0,i.jt)(N.K)],(function(e,n,t,r,i,u){var c=function(e){var t=e.contextId,r=e.pageId;return(0,a.mG)(void 0,void 0,Promise,(function(){return(0,a.Jh)(this,(function(e){switch(e.label){case 0:return[4,n(t,r)];case 1:return[2,e.sent().getAllImplementersOnPageOf(o.XA)[0]]}}))}))};return{appDidMount:function(){e.addWindowMessageHandler({canHandleEvent:function(e){return!!(e.source&&(n=E(e),n&&["TPA","TPA2"].includes(n.intent)));var n},handleEvent:function(e){return(0,a.mG)(this,void 0,void 0,(function(){var n,o,l,p,s,d,f,g,m;return(0,a.Jh)(this,(function(v){switch(v.label){case 0:return n=E(e),o=n.type,l=n.callId,B.includes(o)?[2]:(p=function(e){var n=e.compId;if(n){var o=t.getTpaComponentPageInfo(n);if(!o||!o.contextId){var a=r.getContextIdOfCompId(n);if(a)return{contextId:a,pageId:a}}return o}}(n),s=p&&p.contextId?p.contextId:null,d=t.getTpaComponentIdFromTemplate(n.compId),f=null!=d?d:n.compId,g=(0,a.pi)((0,a.pi)({},n),{compId:f}),m=e.origin,u&&u.tpa.addMessage({message:g,compId:f,contextId:s,origin:m}),s?[4,c(p)]:(console.error("TPA handler message caller does not belong to any page",{type:o,callId:l,compId:f}),[2]));case 1:return v.sent().handleMessage({source:e.source,origin:m,message:g}).catch((function(e){console.error("HandleTpaMessageError",o,s,f,e),null==i||i.captureError(e,{tags:{feature:"tpa",handlerName:o},extra:{handlerName:o,compId:f}})})),[2]}}))}))}})}}})),L=(0,i.ff)([d.xP,s.jj],(function(e,n){var t={};return{cacheProps:function(n,r){var o=g().omitBy(r||e.get(n),g().isFunction);t[n]=g().isEmpty(o)?null:o},getCachedProps:function(e){var r,o,a,i,u=t[e];if(u)return g().isEqual(null===(o=null===(r=n.getCurrentRouteInfo())||void 0===r?void 0:r.dynamicRouteData)||void 0===o?void 0:o.publicData,null===(i=null===(a=n.getPreviousRouterInfo())||void 0===a?void 0:a.dynamicRouteData)||void 0===i?void 0:i.publicData)||delete u.src,u}}})),j=function(e){!function(e){e(o.lP).to(L),e(T.j.AppDidMountHandler).to(J),e(o.ex).to(b),e(o.RN).to(Q),e(o.B_).to(M),e(r.R).to(I),e(r.R).to(h),e(r.R).to(P),e(r.R).to(w),e(r.R).to(S),e(r.R).to(x)}(e),e(r.R).to(C),e(r.R).to(y),e(r.R).to(R),e(o.yA).to(D)}},65070:function(e,n,t){"use strict";t.d(n,{_:function(){return o}});var r=t(31191),o=function(e,n){var t=e.split("/"),o=t.indexOf(n||"");return o<0||t[o]!==n?null:(0,r.CR)(t.splice(o)).slice(1)}}}]);
//# sourceMappingURL=https://static.parastorage.com/services/wix-thunderbolt/dist/tpaCommons.9678f2d1.chunk.min.js.map